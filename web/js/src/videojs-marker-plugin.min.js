/*! @name videojs-marker-plugin @version 0.0.12 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self).videojsMarkerPlugin=t(e.videojs)}(this,function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=(e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e).getComponent("Component"),n=e.getComponent("TimeTooltip"),i=function(r){function a(t,a){var i;return(i=r.call(this,t,a)||this).options=a,i.timeToltip=new n(t),i.timeToltip.hide(),i.addChild(i.timeToltip),i.addClass("vjs-marker-point-tip"),i.timeToltip.el_.innerHTML='\n      <p class="vjs-marker-point-tip-time">'+e.formatTime(i.options.offset,600)+'</p>\n      <p class="vjs-marker-point-tip-content">'+i.options.data.content+"</p>\n    ",i}return t(a,r),a.prototype.updatePosition=function(){this.timeToltip.el_.style.left="-"+this.timeToltip.el_.getBoundingClientRect().width/2+"px"},a}(a),o=function(r){function a(e,t){var a;return(a=r.call(this,e,t)||this).offset=t.offset,a.type=t.type,a.data=t.data,a.tip=new i(e,{data:a.data,offset:a.offset}),a.mouseDisplay=e.getDescendant(["ControlBar","ProgressControl","SeekBar","MouseTimeDisplay"]),a.addChild(a.tip),a.enableTouchActivity(),a.on("mouseenter",function(e){a.mouseDisplay.hide(),a.tip.timeToltip.show(),a.tip.updatePosition()}),a.on("mouseleave",function(e){a.mouseDisplay.show(),a.tip.timeToltip.hide()}),a}t(a,r);var n=a.prototype;return n.createEl=function(){return e.dom.createEl("div",{className:"vjs-marker-point"})},n.updatePosition=function(e){console.log(this.offset,e),this.el_.style.left=this.offset/e*100+"%"},a}(a),s=function(r){function a(e,t){var a;a=r.call(this,e,t)||this,t.markers.forEach(function(e){return a.addChild(e)});return e.on("loadedmetadata",function r(){var a=e.duration();t.markers.forEach(function(e){e.updatePosition(a)}),e.off("loadedmetadata",r)}),a}return t(a,r),a.build=function(e,t){t.markers instanceof Array||(t.markers=[]);for(var r=[],n=t.markers.length;n--;)r.push(new o(e,t.markers[n]));return new a(e,{markers:r,barName:"markerPoint"})},a.prototype.createEl=function(){return e.dom.createEl("div",{className:"vjs-marker-bar"})},a}(e.getComponent("Component"));e.registerComponent("MarkerBar",s);var l=function(r){function a(t,a){var n;n=r.call(this,t,a)||this;for(var i=[],o=a.markers.length,s=0;s<o;s++){var l=a.markers[s];i.push(n.createMarkerItem(l.offset,l.data))}return n.markerList=e.dom.createEl("div",{className:"vjs-markers-panel-list"},{},i),n.el_.appendChild(e.dom.createEl("div",{className:"vjs-markers-panel-title"},{},"打点记录")),n.el_.appendChild(e.dom.createEl("div",{className:"vjs-markers-panel-subtitle"},{},"点击快速跳转至视频打点处")),n.el_.appendChild(n.markerList),n}t(a,r),a.build=function(e,t){return t.markers instanceof Array||(t.markers=[]),new a(e,{markers:t.markers})};var n=a.prototype;return n.createEl=function(){return e.dom.createEl("div",{className:"vjs-markers-panel"})},n.createMarkerItem=function(t,r){var a=this,n=e.dom.createEl("div",{className:"vjs-markers-panel-item-time"},{"data-offset":t},e.formatTime(t,600)),i=e.dom.createEl("div",{className:"vjs-markers-panel-item-content"},{"data-offset":t},r.content),o=e.dom.createEl("div",{className:"vjs-markers-panel-list-item"},{"data-offset":t},[n,i]);return o.addEventListener("click",function(e){var t=e.target;a.player_.currentTime(t.dataset.offset)},!1),o},a}(e.getComponent("Component")),p=e.getPlugin("plugin"),m={},d=function(r){function a(t,a){var n;return(n=r.call(this,t)||this).options=e.mergeOptions(m,a),n.player.addClass("vjs-marker-plugin"),n.updateOptions(),n}t(a,r);var n=a.prototype;return n.createMarkerBar=function(){return this.markerBar=s.build(this.player,{markers:this.options.markers}),this.markerBar},n.createMarkersPanel=function(){return this.markerPanel=l.build(this.player,{markers:this.options.markers}),this.markerPanel},n.updateOptions=function(t){this.options=e.mergeOptions(this.options,t),this.markerBar&&this.markerBar.dispose(),this.markerPanel&&this.markerPanel.dispose(),!1!==this.options.panel&&this.player.addChild(this.createMarkersPanel());var r=this.player.getDescendant(["ControlBar","ProgressControl","SeekBar"]);this.createMarkerBar(),r.addChild(this.markerBar)},a}(p);return d.defaultState={},d.VERSION="0.0.12",e.registerPlugin("markerPlugin",d),d});
